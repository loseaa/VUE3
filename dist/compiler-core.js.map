{
  "version": 3,
  "sources": ["../packages/compiler-core/src/compiler.ts"],
  "sourcesContent": ["import { NodeTypes } from './nodeType.js';\r\n\r\nexport function compile(template: string) {\r\n\tconst ast = parse(template);\r\n\treturn ast;\r\n}\r\n\r\nfunction isEnd(context: any) {\r\n\treturn context.template === '';\r\n}\r\n\r\nfunction getTEXT(context: any) {\r\n\t// \u5199\u4E00\u4E2A\u6B63\u5219\u8868\u8FBE\u5F0F\uFF0C\u63D0\u53D6\u6587\u672C\u5185\u5BB9\uFF0C\u76F4\u5230{{}}\u51FA\u73B0\u6216\u8005<\u51FA\u73B0\r\n\t// \u4E5F\u6709\u53EF\u80FD\u672A\u51FA\u73B0< {{}}\u76F4\u63A5\u4FDD\u7559\u6587\u672C\r\n\tconst match = context.template.match(/(.*?)(?:{{|<)/s);\r\n\tif (match) {\r\n\t\treturn match[1];\r\n\t}\r\n\treturn context.template;\r\n}\r\n\r\nfunction parseText(context: any) {\r\n\tconst content = getTEXT(context);\r\n\t// \u79FB\u9664\u6587\u672C\u5185\u5BB9\r\n\tcontext.template = context.template.slice(content.length);\r\n\treturn {\r\n\t\ttype: NodeTypes.Text,\r\n\t\tcontent,\r\n\t};\r\n}\r\n\r\nfunction advanceBy(context: any, length: number) {\r\n\tcontext.template = context.template.slice(length);\r\n}\r\n\r\nfunction advanceSpace(context: any) {\r\n\tconst match = context.template.match(/^\\s+/);\r\n\tif (match) {\r\n\t\tadvanceBy(context, match[0].length);\r\n\t}\r\n}\r\n\r\nfunction parseAttrs(context: any) {\r\n\tconst attrs: any = [];\r\n\twhile (!isEnd(context)) {\r\n\t\tif (context.template.startsWith('/')) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tconst match = context.template.match(/^(\\w+)\\s*=\\s*\"([^\"]*)\"/);\r\n\t\tif (match) {\r\n\t\t\tattrs.push({\r\n\t\t\t\tname: match[1],\r\n\t\t\t\tvalue: match[2],\r\n\t\t\t});\r\n\t\t\tadvanceBy(context, match[0].length);\r\n      advanceSpace(context);\r\n\t\t} else {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\treturn attrs;\r\n}\r\n\r\nfunction parseElement(context: any) {\r\n  // \u89E3\u6790\u6807\u7B7E\u540D\r\n\t// \u5982\u679C\u662F\u7ED3\u675F\u6807\u7B7E \u76F4\u63A5\u8FD4\u56DEnull,\u7528\u6B63\u5219\u8868\u8FBE\u5F0F\u6765\u5339\u914D\u7ED3\u675F\u6807\u7B7E\r\n  let match\r\n  if(match=context.template.match(/^<\\/\\w+>/)) {\r\n    advanceBy(context, match[0].length);\r\n    return null;\r\n  }\r\n  \r\n  debugger\r\n\r\n  match = context.template.match(/^<(\\w+)/);\r\n  advanceBy(context, 1);\r\n  if (!match) {\r\n    return null;\r\n  }\r\n  \r\n  const tag = match[1];\r\n  advanceBy(context, tag.length);\r\n  advanceSpace(context);\r\n  let isSelfClosing = context.template.startsWith('/');\r\n  if (isSelfClosing) {\r\n    advanceBy(context, 1);\r\n  }\r\n  advanceSpace(context);\r\n\r\n  const attrs = parseAttrs(context);\r\n  advanceSpace(context);\r\n  advanceBy(context,1);\r\n  let children=parseChildren(context);\r\n  \r\n\treturn {\r\n\t\ttype: NodeTypes.Element,\r\n\t\ttag,\r\n    children,\r\n    isSelfClosing,\r\n    attrs\r\n  };\r\n}\r\n\r\nfunction parseChildren(context: any) {\r\n\tlet children: any = [];\r\n\twhile (!isEnd(context)) {\r\n\t\tif (context.template.startsWith('{{')) {\r\n\t\t\t// children.push(parseText(context))\r\n\t\t} else if (context.template.startsWith('<')) {\r\n      let child =parseElement(context)\r\n      if(child) {\r\n        children.push(child)\r\n      }else{\r\n        break\r\n      }\r\n\t\t} else {\r\n\t\t\tchildren.push(parseText(context));\r\n\t\t}\r\n\t}\r\n\treturn children;\r\n}\r\n\r\nfunction parse(template: string) {\r\n\tconst context = {\r\n\t\tsource: template,\r\n\t\ttemplate,\r\n\t};\r\n\tlet children = parseChildren(context);\r\n\tconst ast = {\r\n\t\ttype: NodeTypes.Root,\r\n\t\ttag: 'Root',\r\n\t\tchildren,\r\n\t};\r\n\treturn ast;\r\n}\r\n"],
  "mappings": ";AAEO,SAAS,QAAQ,UAAkB;AACzC,QAAM,MAAM,MAAM,QAAQ;AAC1B,SAAO;AACR;AAEA,SAAS,MAAM,SAAc;AAC5B,SAAO,QAAQ,aAAa;AAC7B;AAEA,SAAS,QAAQ,SAAc;AAG9B,QAAM,QAAQ,QAAQ,SAAS,MAAM,gBAAgB;AACrD,MAAI,OAAO;AACV,WAAO,MAAM,CAAC;AAAA,EACf;AACA,SAAO,QAAQ;AAChB;AAEA,SAAS,UAAU,SAAc;AAChC,QAAM,UAAU,QAAQ,OAAO;AAE/B,UAAQ,WAAW,QAAQ,SAAS,MAAM,QAAQ,MAAM;AACxD,SAAO;AAAA,IACN;AAAA,IACA;AAAA,EACD;AACD;AAEA,SAAS,UAAU,SAAc,QAAgB;AAChD,UAAQ,WAAW,QAAQ,SAAS,MAAM,MAAM;AACjD;AAEA,SAAS,aAAa,SAAc;AACnC,QAAM,QAAQ,QAAQ,SAAS,MAAM,MAAM;AAC3C,MAAI,OAAO;AACV,cAAU,SAAS,MAAM,CAAC,EAAE,MAAM;AAAA,EACnC;AACD;AAEA,SAAS,WAAW,SAAc;AACjC,QAAM,QAAa,CAAC;AACpB,SAAO,CAAC,MAAM,OAAO,GAAG;AACvB,QAAI,QAAQ,SAAS,WAAW,GAAG,GAAG;AACrC;AAAA,IACD;AACA,UAAM,QAAQ,QAAQ,SAAS,MAAM,wBAAwB;AAC7D,QAAI,OAAO;AACV,YAAM,KAAK;AAAA,QACV,MAAM,MAAM,CAAC;AAAA,QACb,OAAO,MAAM,CAAC;AAAA,MACf,CAAC;AACD,gBAAU,SAAS,MAAM,CAAC,EAAE,MAAM;AAC/B,mBAAa,OAAO;AAAA,IACxB,OAAO;AACN;AAAA,IACD;AAAA,EACD;AACA,SAAO;AACR;AAEA,SAAS,aAAa,SAAc;AAGlC,MAAI;AACJ,MAAG,QAAM,QAAQ,SAAS,MAAM,UAAU,GAAG;AAC3C,cAAU,SAAS,MAAM,CAAC,EAAE,MAAM;AAClC,WAAO;AAAA,EACT;AAEA;AAEA,UAAQ,QAAQ,SAAS,MAAM,SAAS;AACxC,YAAU,SAAS,CAAC;AACpB,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,EACT;AAEA,QAAM,MAAM,MAAM,CAAC;AACnB,YAAU,SAAS,IAAI,MAAM;AAC7B,eAAa,OAAO;AACpB,MAAI,gBAAgB,QAAQ,SAAS,WAAW,GAAG;AACnD,MAAI,eAAe;AACjB,cAAU,SAAS,CAAC;AAAA,EACtB;AACA,eAAa,OAAO;AAEpB,QAAM,QAAQ,WAAW,OAAO;AAChC,eAAa,OAAO;AACpB,YAAU,SAAQ,CAAC;AACnB,MAAI,WAAS,cAAc,OAAO;AAEnC,SAAO;AAAA,IACN;AAAA,IACA;AAAA,IACE;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAEA,SAAS,cAAc,SAAc;AACpC,MAAI,WAAgB,CAAC;AACrB,SAAO,CAAC,MAAM,OAAO,GAAG;AACvB,QAAI,QAAQ,SAAS,WAAW,IAAI,GAAG;AAAA,IAEvC,WAAW,QAAQ,SAAS,WAAW,GAAG,GAAG;AACzC,UAAI,QAAO,aAAa,OAAO;AAC/B,UAAG,OAAO;AACR,iBAAS,KAAK,KAAK;AAAA,MACrB,OAAK;AACH;AAAA,MACF;AAAA,IACJ,OAAO;AACN,eAAS,KAAK,UAAU,OAAO,CAAC;AAAA,IACjC;AAAA,EACD;AACA,SAAO;AACR;AAEA,SAAS,MAAM,UAAkB;AAChC,QAAM,UAAU;AAAA,IACf,QAAQ;AAAA,IACR;AAAA,EACD;AACA,MAAI,WAAW,cAAc,OAAO;AACpC,QAAM,MAAM;AAAA,IACX;AAAA,IACA,KAAK;AAAA,IACL;AAAA,EACD;AACA,SAAO;AACR;",
  "names": []
}
